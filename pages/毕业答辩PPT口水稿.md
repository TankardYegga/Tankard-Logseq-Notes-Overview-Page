- 各位老师好，我是邹刘文。我今天答辩的题目是“基于深度学习的乳腺肿块超声图像分割算法研究”，我的论文指导老师是计算机学院的jean-louis和杨淳沨老师，以及生物医学工程学院的周光泉老师。我将按照选题背景与研究现状、“肿块多样性”的研究思路及成果、“肿块边界模糊”的研究思路及成果、总结与展望以及作者简介这五个方面进行论述，其中第三部分是我的答辩重点。
- 第一部分首先进入选题背景，现代科技大幅提升了人们的物质生活水平，但是人们的健康状况却迎来了新风险；左边的上下两张图，分别是中国女性在2000-2018年间各类癌症年龄标准化后的发病率和致死率变化情况图，其中灰线代表乳腺癌，从图中不难看出发病率一直在快速攀升，而致死率总体上平稳增加；这一现象主要与体育活动减少、精神抑郁风险增加等生活方式的改变相关。目前，超声成像是乳腺癌早期筛查的首选手段，它是非侵入式的、成本低廉的，所以可以用于大规模筛查，同时它的成像效果实时可见、比钼靶射线具有更高的病变检出率，所以检查效果相对灵敏。在得到乳腺超声成像结果之后，通常我们需要在图像上执行乳腺肿块分割任务，这是我论文的研究目标，该任务通过定位到的病灶为后续的治疗方案制定、手术制定和药效评估提供了有效依据。然而，该分割任务存在两大挑战，一是乳腺肿块自身极具多样性，而多样性也就是复杂性，比如左图最上面一行中肿块可能在图像上方的左边 中间 和右边，也可能在图像正中央和下方，甚至第三行显示肿块的大小也可能是多个；二是肿块边界模糊，而模糊也就是信息不足，这种不足来自于斑点噪音、低对比度的双重干扰，尤其是低对比度会使得肿块与非肿块难以区分。
- 然后通过文献调研，目前的研究大方向分为传统方法和深度学习两类。关于传统方法，一类是基于区域、基于模型或两者的混合，但是过于依赖先验知识；另外一类是经典机器学习模型，不是端到端所以在理论上是次优的。关于深度学习方法：1）针对“肿块多样性”问题，主要是通过引入多尺度增大感受野、增加宽度深度来提升泛化性这两个策略来提升模型的数据自适应能力，右上图左边是通过多尺度的卷积来捕获多尺度的特征，而右边是依据对象大小来选择合适的尺度特征，右下图是15层的嵌套U-net；2）针对“肿块边界模糊”问题，有三类战术，第一类是直接引导有利信息，比如右上图中在各级编码器出口处都增加一个边界预测的监督分支，右下图中对输入进行边缘模糊处理；第二类是通过多任务学习来间接引导有利信息，比如图中对输入图片先经过U-net分割，然后将分割结果与原图融合再用于乳腺癌的良恶性分类；第三类是将边界像素视作困难样本而与其他像素区别开来，这也是最重要的战术，右下图将边界预测结果划分为多个方块，然后结合逆变换网络设计了一个边界感知的损失函数，更重要的一种思路是认为边界像素点的预测不确定性高或者说置信度低，希望通过增强其特征来优化粗糙分割结果，用到的特征增强策略有反向残差连接、级联迭代、融合多尺度以及让肿块和非肿块通过边界产生特征隔离。
- 第二部分针对“肿块多样性”问题，论述我的研究工作。如图所示，我在U-net的同一个尺度上将编码器的两个卷积替换成了改进版的多尺度通道注意力模块，以及将普通残差连接替换成空间自注意力残差连接模块。不同于大多数论文中在所有尺度上都替换新模块，这里直接复用U-net自身具有的多尺度惯性以降低参数量。具体来说，第一个模块中首先使用三个不同尺度的卷积模块提取特征，分别是5 * 5的普通卷积（上方的绿线）、3 * 3的普通卷积（中间的黄线）和3 * 3但是膨胀率为2的空洞卷积（下方的蓝线）；然后将三个尺度分为两组，在组内使用通道注意力计算权重，从图中可以看到第一组内计算出的权重分别为（1-a）和a，第二组中则分别为（1-b）和b；中间尺度在两组中都出现了，所以其最终权重被设置为a和b的平均值，而其余两个尺度的权重也缩小为1/2，这样能保证三个尺度的权重之和依旧为1。至于第二个模块则非常简单，让解码器特征充当key参与空间transformer的计算，利用计算出的权重对编码器特征加权，加权后再连接。关于该模型架构进行了若干实验，实验使用的是包含133张正常乳腺、210张良性乳腺和437张恶性乳腺的BUSI数据集，预处理步骤包括合并肿块、调整为正方形、移除正常乳腺、划分等；评价指标使用了DSC和JI，这五个指标都是越大分割效果越好；损失函数使用了二元交叉熵损失和DICE损失1比1混合的综合值。实验设计这一块主要是两个模块单独的参数实验和两者的组合实验，模块一的参数包括嵌入的尺度位置、空洞卷积的卷积核参数、以及将空洞卷积替换为普通卷积后的参数，后面两个参数是互斥的；模块二的参数只有嵌入的尺度位置。
- 第三部分针对“肿块边界模糊”问题，论述我两个不同思路的研究工作。思路一是考虑到物理性输入因素无法改变，转而希望在特征图层面能够放大边缘的细节特征，这具体是通过将热力学中的扩散方程应用到特征图上得到特征扩散过程。首先在物理学中物质会在液体气体等介质中发生连续扩散过程：该过程在空间上满足菲克定律，也就是扩散通量f等于负的g乘以浓度的梯度，扩散通量f的定义是在空间某点向外发射的物质密度，菲克定律既能说明扩散通量与浓度变化的方向相反，也能说明通量的大小与浓度变化的大小成g的正比例关系，这里的g也被称作扩散系数；该过程在时间上满足连续性方程，因为质量守恒，所以浓度的变化量等于通量的体积变化率，也就是公式中的浓度对时间求导，等于通量散度的相反数；将菲克定律和连续性方程联合可推导出扩散方程，方程中消去了扩散通量f而变成了只关于浓度自身的等式。然后将扩散方程进行离散化处理，左边离散化为相邻时刻同一位置处的浓度差，右边离散化为X Y Z三个方位的邻居像素位置与当前位置的浓度差之和，右边离散化时将二阶导简化成了一阶导。最后将其改进后应用到特征图上得到边缘扩散单元，该单元内将每个像素点的特征向量视作每个像素点的浓度，利用周围像素的特征扩散过程来更新当前像素的特征，改进之处有三，一是扩散方向变成了3 * 3范围内的8个邻居，也就是图示中的Pn0到Pn7, 二是将求和改成了平均以减小整体误差，三是将g替换成了线性扩散矩阵θ；该单元被考虑嵌入到单个解码器计算流程的中间位置，也就是上采样之后、卷积之前。该思路的实验设计分为三块，一块是迭代次数和扩散矩阵的参数实验，另一块是嵌入解码器流程内部位置的参数实验，最后一块是在U-net、Att U-net和U-net++上在四个不同尺度层级嵌入时的对比实验。第一块的实验结果是迭代2次且每次迭代使用不同的扩散矩阵取得最大DSC，这说明需要较大的感受野且不同感受野的聚合程度不同；第二块的实验结果是放在中间位置最好；最后一块的定量结果说明在三个U型网络上的Decoder3之后添加边缘扩散单元后都取得了较为明显的提升，而从定性结果的前两列可以看到添加后边界细节视觉上变得模糊了但实际上是边界信息向外扩展了。
- 思路二是从模型自身结构出发来改进，认为其不平衡的损失函数和上采样过程对边界信息的巨大影响是导致边界预测不确定性高的本质原因。模型分为两阶段，第一阶段是常见的粗糙分割结果预测，第二阶段提出了全新的细化分割工作流，先通过不确定性计算方法从粗糙分割特征图coarse_features中得到不确定性掩膜uncertainty_mask, 然后再使用精细特征提取模块来得到精细特征fine_features，最后在不确定性减小模块中利用精细特征来增强不确定区域的特征，进而得到细化后的分割特征图refined_features。先看后面浅绿色框中的模块二，将三个解码器特征先上采样再转换到相同的维度后连接，再通过通道注意力来加权聚合，聚合后的特征同时用于乳腺癌良恶性分类来进行监督；再看深绿色框中的模块三，是只将不确定区域的特征更新为（coarse_features和fine_features的均值）。再来看模块一中不确定性计算的方法，最常用的是数学公式法，但是我在这里又设计另外了两种，第一种是膨胀操作结果和腐蚀操作结果的平均，得到了包含M N O的三元图，M的灰度是255，N是outside_band和inside_band的并集，灰度是127.5，而O的灰度是0；第二种是从膨胀操作结果中减去原图，这里的P和R灰度值都为0，而Q为255，也就是outside_band。该思路的实验设计是针对三个模块的，模块一主要涉及三种不确定性计算方法的定性和定量对比，以及不同方法的拓展实验，但是这些扩展没有达到预期的更好的效果，就不仔细提了，模块二和模块三分别是关于特征来源和特征增强方式的对比实验。定量结果说明膨胀操作和腐蚀操作的平均法最好，取得最大DSC值77.57, 但是三种方法都是有效的。而关于定性对比，从四张良性和四张恶性样本的前景对比可以看出，第二种方法的边界线最细同时分割效果最好，但是却是由离散的多个边界片段组成的，这个表是三种方法按照不同对比维度得出的排序结果；从执行结果的中间可视化对比来看，从左图中的a）列和c）列的对比可知第一种方法的确较大程度上减小了不确定性，而右图的c）列和e）列的对比并不明显，可能是因为第二种方法本身的uncertainty_mask前景就比较细小，最后一张图中的c）列和e）列的对比说明第三种方法也的确降低了不确定性；从三种方法都不怎么奏效的图像特点上，如肿块内部有白色组织隔离、边界与黑色背景混合，能看出三种方法依旧有局限性。三种方法两两混合的实验并没有起到并单个方法更好的效果，混合之后的前景部分变得混乱。针对模块二的实验，将三个解码器中的其中一个分别替换成对应尺度的编码器、以及取跨两个尺度的三个解码器Decoder0 Decode2和瓶颈层，但是都没有取得更优的效果。针对模块三的实验，使用全部的fine_features、将fine_features和coarse_features先连接后聚合也没有取得更优效果。
-